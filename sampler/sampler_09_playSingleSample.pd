#N canvas 429 28 634 458 12;
#X obj 125 17 bng 25 250 50 0 fromBangOpenpanel empty empty 17 7 0
10 -260097 -260097 -260097;
#X floatatom 13 71 5 0 1.5 0 - toAmp fromAmp;
#X floatatom 12 143 15 0 0 0 - toPhasorFreq fromPhasorFreq;
#N canvas 0 22 450 278 (subpatch) 0;
#X array buf1L 2.17088e+06 float 2;
#X coords 0 1 2.17088e+06 -1 600 100 1 0 0;
#X restore 12 238 graph;
#X obj 15 258 hsl 595 60 0 1 0 0 empty toCsrL empty -2 -8 0 10 -262144
-1 -1 0 1;
#X obj 93 17 tgl 25 0 fromDSPtog empty empty 17 7 0 10 -257985 -1 -1
0 1;
#X text 121 142 <-phasor frequency;
#X floatatom 12 166 15 0 0 0 - toCurrSamp -;
#X text 121 164 <-current sample index;
#N canvas 0 22 450 278 (subpatch) 0;
#X array buf1R 2.17088e+06 float 2;
#X coords 0 1 2.17088e+06 -1 600 100 1 0 0;
#X restore 12 338 graph;
#X obj 15 360 hsl 595 60 0 1 0 0 empty toCsrR empty -2 -8 0 10 -262144
-1 -1 0 1;
#X floatatom 56 71 8 0 0 0 - toSpdNB fromSpdNB;
#X floatatom 124 71 8 0 1 0 - toStartPct fromStartPct;
#X floatatom 199 71 8 0 1 0 - toEndPct fromEndPct;
#X obj 15 238 hsl 595 20 0 1 0 0 empty toStartPct empty -2 -8 0 10
-262144 -4034 -1 0 1;
#X obj 15 318 hsl 595 20 0 1 0 0 empty toEndPct empty -2 -8 0 10 -262144
-4032 -1 59400 1;
#X obj 15 188 hsl 595 25 0 1 0 0 toStartPct empty empty -2 -8 0 10
-4034 -1 -1 0 1;
#X obj 15 213 hsl 595 25 0 1 0 0 toEndPct empty empty -2 -8 0 10 -4032
-1 -1 0 1;
#N canvas 69 22 1766 1031 subpatch 1;
#X obj 69 134 soundfiler;
#X obj 65 58 openpanel;
#X obj 32 225 expr 44100 / $f1;
#X obj 138 368 phasor~;
#X obj 114 436 *~;
#X obj 67 926 *~;
#X obj 63 955 dac~, f 7;
#X obj 299 318 unsig~ 50;
#X msg 178 56 \; pd dsp \$1;
#X obj 288 501 unsig~ 50;
#X msg 566 43 1;
#X obj 151 430 send~ toBuf1Graph;
#X obj 299 293 receive~ toBuf1Graph;
#X msg 69 97 read -resize \$1 buf1L buf1R;
#X obj 49 526 tabread4~ buf1L;
#X obj 168 526 tabread4~ buf1R;
#X obj 145 925 *~;
#X obj 135 313 f;
#X obj 137 341 *;
#X obj 183 243 t b f;
#X obj 302 3 loadbang;
#X msg 302 44 1;
#X msg 382 43 0;
#N canvas 714 68 1206 583 partialSample 0;
#X obj 142 36 r fromStartPct;
#X obj 403 40 r fromEndPct;
#X obj 209 243 expr if($f2>$f1 \, $f2-$f1 \, $f1-$f2);
#X floatatom 209 280 5 0 0 0 - - -;
#X obj 403 77 t b f;
#X text 470 76 <-expr will only output with input to left inlet. Use
trigger to force output with input to right inlet., f 37;
#X text 562 244 <-use expr and an if statement to insure that total
percentage is always positive, f 41;
#X obj 171 345 *~;
#X text 213 345 <-multiply phasor 0-1 sig by percentage of the partial
sample, f 61;
#X obj 109 417 +~;
#X text 151 418 <-add start percentage to start at the right point
;
#X obj 108 477 outlet~ adjusted phasor;
#X obj 21 3 inlet~ phasor 0-1;
#X text 350 475 <-use inlet~/outlet~ for signals;
#X obj 266 313 s fromPartPct;
#X text 411 314 <-send to adjust phasor frequency;
#X text 394 161 <-use expr and an if statement to correct start point
;
#X obj 41 162 expr if($f2>$f1 \, $f1 \, $f2);
#X obj 22 534 s adjStartPct;
#X text 121 535 <-already did the work here to make sure which is the
start point;
#X connect 0 0 2 0;
#X connect 0 0 17 0;
#X connect 1 0 4 0;
#X connect 2 0 3 0;
#X connect 3 0 7 1;
#X connect 3 0 14 0;
#X connect 4 0 2 0;
#X connect 4 0 17 0;
#X connect 4 1 2 1;
#X connect 4 1 17 1;
#X connect 7 0 9 0;
#X connect 9 0 11 0;
#X connect 12 0 7 0;
#X connect 17 0 9 1;
#X connect 17 0 18 0;
#X restore 142 399 pd partialSample;
#X obj 198 193 t b f;
#X obj 185 217 * 1;
#X obj 198 167 expr 1/$f1;
#X msg 483 41 1;
#X obj 382 67 s toStartPct;
#X obj 483 71 s toEndPct;
#X obj 302 68 s toSpdNB;
#X obj 186 120 r fromSpdNB;
#X obj 289 528 s toCurrSamp;
#X obj 567 71 s toAmp;
#X obj 1454 613 r fromAmp;
#X obj 299 346 s toCsrL;
#X obj 363 346 s toCsrR;
#X obj 176 18 r fromDSPtog;
#X obj 28 17 r fromBangOpenpanel;
#X obj 199 142 r fromPartPct;
#X obj 7 307 s toPhasorFreq;
#X obj 588 490 threshold~;
#X text 672 482 <-threshold~ is reading from the current sample index
and will detect when a certain threshold is reached;
#X text 261 390 <-look here for a few adjustments, f 19;
#X obj 871 108 r adjStartPct;
#X obj 875 187 +;
#X obj 914 159 t b f;
#X obj 914 133 r fromPartPct;
#X text 870 83 calculates end percentage;
#X obj 525 178 r adjStartPct;
#X obj 25 194 s fromTotalSamps;
#X obj 767 221 *;
#X obj 734 187 r fromTotalSamps;
#X obj 28 162 f;
#X obj 626 24 delay 5;
#X text 798 220 <-multiple by total samples to get threshold;
#X obj 1299 902 vline~;
#X obj 1374 648 r fromRel;
#X obj 1538 621 r fromAtk;
#X obj 1614 621 r fromSus;
#X obj 1703 621 r fromDecay;
#X text 1283 985 vline~ takes triplets: destination \, time \, initial
delay;
#X obj 1328 687 bng 15 250 50 0 empty toBangEnv empty 17 7 0 10 -262144
-1 -1;
#X text 1601 865 have to fudge order because the first inlet in pack
above triggers envelope and we only want to trigger them manually or
on amplitude changes;
#X msg 1400 854 0 \$2 \, \$1 \$3 \$4 \, \$5 \$6 \$7;
#X text 1602 820 \$2-release time \, \$1 amp level \, \$3 attack time
\, \$4 attack delay \, \$5 sustain level \, \$6 decay time \, \$7 sustain
delay;
#X obj 1546 648 t b f;
#X obj 1376 687 + 100;
#X text 1424 687 <-attack delay is release + 100ms to have noticable
attack;
#X obj 1674 772 + 200;
#X text 1721 773 <-decay delay is release time + attack time + 100ms
;
#X obj 1404 824 pack 1 100 15 200 1 0 5000;
#X obj 1567 725 * 1;
#X text 1280 934 change line~ to vline~ object to do a proper adsr
envelope. Because we are doing threshold~ to detect the end of a sample
\, we will release first then attack and sustain;
#X text 1598 725 multiply sustain level by amplitude so you get percentage
of total amp;
#X obj 1467 645 t b f;
#X obj 589 519 s toBangEnv;
#X obj 1287 89 samplerate~;
#X obj 1254 8 r fromRel;
#X obj 1254 37 / 1000;
#X obj 1257 115 * 1;
#X obj 1255 62 t f b;
#X text 1128 63 calculate release time in samples from milliseconds
, f 15;
#X msg 588 448 set \$1 0 \$1 0;
#X obj 613 207 *;
#X obj 672 129 r fromSpdNB;
#X obj 605 242 t b f;
#X obj 508 471 *~ 1;
#X obj 455 302 expr if($f1<0 \, -1 \, 1);
#X obj 672 155 t f b f;
#X msg 708 36 100;
#X obj 708 60 s toRel;
#X msg 769 34 15;
#X obj 768 58 s toAtk;
#X obj 831 58 s toSus;
#X msg 832 34 1;
#X msg 892 37 0;
#X obj 892 61 s toDecay;
#X obj 578 376 expr if($f3<0 \, ($f2+$f4)* -1 \, $f1-$f4);
#X obj 1131 259 t b f;
#X obj 1278 177 t b f;
#X obj 1277 147 r fromSpdNB;
#X obj 1230 210 * 1;
#X obj 1195 240 expr abs($f1);
#X text 357 133 when going backwards \, threshold needs to read everything
as negative values. Make the current sample index negative and make
the threshold negative, f 23;
#X text 858 374 subtract release time (in samples) to start envelope
before sample ends, f 23;
#X text 1367 144 Have to multiply by speed to get proper duration of
release time, f 36;
#X msg 199 821 0 \$1;
#X text 216 558 Stop loop sequence;
#X obj 216 600 r fromStopLoop;
#X text 216 576 1) Release envelope;
#X obj 250 666 s toRel;
#X obj 224 693 r fromRel;
#X text 295 722 2) Phasor frequency to zero after release is finished
, f 27;
#X obj 295 782 delay 100;
#X obj 295 757 t b f;
#X msg 268 261 0;
#X obj 270 233 r toPhasor0;
#X obj 120 267 r toCurrPhasorFreq;
#X obj 294 813 s toPhasor0;
#X text 515 579 Start loop sequence;
#X text 515 601 1) Phasor frequency to current freq;
#X obj 517 620 r fromStartLoop;
#X obj 691 670 s toCurrPhasorFreq;
#X text 515 698 2) Attack envelope, f 27;
#X obj 629 676 s toAtk;
#X obj 636 727 r fromAtk;
#X obj 565 678 s toAmp;
#X msg 512 835 \$1 \$2;
#X obj 512 804 pack f f;
#X obj 547 725 r fromAmp;
#X text 831 522 One shot sequence;
#X text 831 544 1) Stop loop;
#X obj 1268 853 r toVline;
#X obj 199 855 s toVline;
#X msg 835 705 0 \$1;
#X obj 867 615 s toRel;
#X obj 887 640 r fromRel;
#X obj 931 734 delay 100;
#X obj 931 709 t b f;
#X obj 989 793 s toPhasor0;
#X obj 835 565 r fromOneShot;
#X obj 835 733 s toVline;
#X text 772 772 2) Return to start of sample, f 17;
#X text 952 814 find out which direction we are going;
#X obj 780 815 r fromSpdNB;
#X obj 877 813 s toSpdNB;
#X obj 728 909 route 0 1;
#X obj 729 874 < 0;
#X obj 700 981 s toStartPct;
#X obj 668 953 t b b;
#X obj 664 1039 f;
#X obj 682 1011 r fromStartPct;
#X obj 821 958 t b b;
#X obj 817 1044 f;
#X obj 853 986 s toEndPct;
#X obj 835 1016 r fromEndPct;
#X obj 217 630 t b b;
#X obj 207 722 f;
#X obj 517 645 t b b b b;
#X obj 615 774 f;
#X obj 475 672 t b b;
#X obj 525 759 f;
#X obj 835 590 t b b;
#X obj 869 666 f;
#X obj 932 760 t b b b;
#X obj 763 840 f;
#X obj 192 337 r toSetPhase;
#X obj 712 1106 s toSetPhase;
#X connect 0 0 2 0;
#X connect 0 0 4 1;
#X connect 0 0 53 0;
#X connect 1 0 13 0;
#X connect 2 0 17 0;
#X connect 2 0 40 0;
#X connect 3 0 23 0;
#X connect 4 0 9 0;
#X connect 4 0 14 0;
#X connect 4 0 15 0;
#X connect 4 0 87 0;
#X connect 5 0 6 0;
#X connect 7 0 35 0;
#X connect 7 0 36 0;
#X connect 9 0 32 0;
#X connect 10 0 33 0;
#X connect 12 0 7 0;
#X connect 13 0 0 0;
#X connect 14 0 5 0;
#X connect 15 0 16 0;
#X connect 16 0 6 1;
#X connect 17 0 18 0;
#X connect 18 0 3 0;
#X connect 19 0 17 0;
#X connect 19 1 18 1;
#X connect 20 0 21 0;
#X connect 20 0 22 0;
#X connect 20 0 27 0;
#X connect 20 0 10 0;
#X connect 20 0 54 0;
#X connect 20 0 90 0;
#X connect 20 0 96 0;
#X connect 20 0 95 0;
#X connect 20 0 92 0;
#X connect 21 0 30 0;
#X connect 22 0 28 0;
#X connect 23 0 4 0;
#X connect 23 0 11 0;
#X connect 24 0 25 0;
#X connect 24 1 25 1;
#X connect 25 0 19 0;
#X connect 26 0 24 0;
#X connect 27 0 29 0;
#X connect 31 0 25 0;
#X connect 34 0 71 0;
#X connect 34 0 75 0;
#X connect 37 0 8 0;
#X connect 38 0 1 0;
#X connect 39 0 26 0;
#X connect 41 0 76 0;
#X connect 44 0 45 0;
#X connect 45 0 51 0;
#X connect 46 0 45 0;
#X connect 46 1 45 1;
#X connect 47 0 46 0;
#X connect 49 0 84 0;
#X connect 51 0 98 0;
#X connect 52 0 51 1;
#X connect 52 0 84 1;
#X connect 53 0 50 0;
#X connect 54 0 53 0;
#X connect 56 0 5 1;
#X connect 56 0 16 1;
#X connect 57 0 67 0;
#X connect 57 0 71 1;
#X connect 58 0 66 0;
#X connect 58 0 71 2;
#X connect 59 0 72 0;
#X connect 60 0 71 5;
#X connect 62 0 71 0;
#X connect 64 0 56 0;
#X connect 66 0 69 0;
#X connect 66 1 69 1;
#X connect 67 0 69 0;
#X connect 67 0 71 3;
#X connect 69 0 71 6;
#X connect 71 0 64 0;
#X connect 72 0 71 4;
#X connect 75 0 72 0;
#X connect 75 1 72 1;
#X connect 77 0 80 1;
#X connect 78 0 79 0;
#X connect 79 0 81 0;
#X connect 80 0 102 0;
#X connect 81 0 80 0;
#X connect 81 1 77 0;
#X connect 83 0 41 0;
#X connect 84 0 86 0;
#X connect 85 0 89 0;
#X connect 86 0 98 0;
#X connect 86 1 98 1;
#X connect 87 0 41 0;
#X connect 88 0 87 1;
#X connect 89 0 88 0;
#X connect 89 1 98 0;
#X connect 89 2 98 2;
#X connect 90 0 91 0;
#X connect 92 0 93 0;
#X connect 95 0 94 0;
#X connect 96 0 97 0;
#X connect 98 0 83 0;
#X connect 99 0 98 0;
#X connect 99 1 98 3;
#X connect 100 0 102 0;
#X connect 100 1 102 1;
#X connect 101 0 100 0;
#X connect 102 0 103 0;
#X connect 103 0 99 0;
#X connect 107 0 134 0;
#X connect 109 0 157 0;
#X connect 112 0 158 1;
#X connect 114 0 119 0;
#X connect 115 0 114 0;
#X connect 115 1 114 1;
#X connect 116 0 3 0;
#X connect 117 0 116 0;
#X connect 118 0 17 0;
#X connect 122 0 159 0;
#X connect 126 0 160 1;
#X connect 128 0 134 0;
#X connect 129 0 128 0;
#X connect 130 0 162 1;
#X connect 133 0 56 0;
#X connect 135 0 142 0;
#X connect 137 0 164 1;
#X connect 138 0 165 0;
#X connect 139 0 138 0;
#X connect 139 1 138 1;
#X connect 141 0 163 0;
#X connect 145 0 166 1;
#X connect 147 0 150 0;
#X connect 147 1 153 0;
#X connect 148 0 147 0;
#X connect 150 0 151 0;
#X connect 150 1 149 0;
#X connect 151 0 168 0;
#X connect 152 0 151 1;
#X connect 153 0 154 0;
#X connect 153 1 155 0;
#X connect 154 0 168 0;
#X connect 156 0 154 1;
#X connect 157 0 158 0;
#X connect 157 1 111 0;
#X connect 158 0 115 0;
#X connect 158 0 107 0;
#X connect 159 0 161 0;
#X connect 159 1 127 0;
#X connect 159 2 125 0;
#X connect 159 3 123 0;
#X connect 160 0 129 1;
#X connect 161 0 162 0;
#X connect 161 1 160 0;
#X connect 162 0 129 0;
#X connect 163 0 164 0;
#X connect 163 1 136 0;
#X connect 164 0 139 0;
#X connect 164 0 135 0;
#X connect 165 0 166 0;
#X connect 165 1 146 0;
#X connect 165 2 140 0;
#X connect 166 0 148 0;
#X connect 167 0 3 1;
#X restore 13 446 pd subpatch;
#X text 154 17 Load Sample, f 6;
#X text 13 17 Start/Stop DSP, f 10;
#X text 11 52 Amp;
#X text 54 52 Speed;
#X text 122 52 Start Pct;
#X text 197 52 End Pct;
#N canvas 502 59 759 564 theory 1;
#X text 52 42 Method to start and stop looping sample;
#X text 52 68 Stop:;
#X text 52 94 1) Release envelope;
#X text 52 120 2) Phasor frequency to 0;
#X text 52 146 Start:;
#X text 52 172 1) Phasor frequency to selected one;
#X text 52 198 2) Attack envelope;
#X text 52 224 One Shot Sample:;
#X text 52 250 1) Stop looping sample if needed;
#X text 52 276 2) Return sample to start point;
#X text 52 302 3) Phasor frequency to selected one;
#X text 52 328 4) Attack sample;
#X text 52 354 5) Play to end point;
#X text 52 380 6) Release envelope;
#X text 52 16 Program the following sequences:, f 42;
#X text 52 406 7) Phasor frequency 0;
#X restore 471 11 pd theory read me;
#X floatatom 12 114 10 0 100000 0 - toRel fromRel;
#X floatatom 100 114 10 0 100000 0 - toAtk fromAtk;
#X floatatom 187 114 10 0 100000 0 - toSus fromSus;
#X floatatom 268 114 10 0 100000 0 - toDecay fromDecay;
#X text 9 95 rel;
#X text 97 95 atk;
#X text 184 95 sus;
#X text 264 95 decay;
#X obj 206 19 bng 25 250 50 0 fromStopLoop toStopLoop empty 17 7 0
10 -258113 -262144 -262144;
#X text 233 14 Stop Loop, f 4;
#X obj 270 19 bng 25 250 50 0 fromStartLoop toStartLoop empty 17 7
0 10 -4034 -262144 -262144;
#X text 297 14 Start Loop, f 5;
